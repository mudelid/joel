
<!doctype html>
<html lang="et">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>JOELI KOLLEKTSIOON</title>
  <style>
@font-face {
  font-family: 'BebasKai';
  src: url('fonts/bebaskai.woff2') format('woff2'),
       url('fonts/bebaskai.woff') format('woff');
  font-weight: normal;
  font-style: normal;
}

    :root{
      --bg:#FFFFFF; --panel:#FFFFFF; --text:#000000; --muted:#000000; --border:#000000; --link:#000000;
      --maxw:500px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body {
  margin:0;
  background: url("img/taust3.jpg?v=2") no-repeat center center fixed;
  background-size: cover;
  color: var(--text);
  font-family: 'BebasKai', sans-serif;
  font-size: 30px;
}
    /* Väike logo vasakusse ülanurka */
    .logo{position:fixed; top:12px; left:12px; width:100px; height:100px; border-radius:7px; object-fill:cover; border:1px solid var(--border); background:#FFFFFF}
    header{max-width:var(--maxw); margin:60px auto 10px; padding:0 16px}
    h1{margin:0 0 6px; font-size:50px; }
    p.lead{margin:0; color:var(--muted)}
    main{max-width:var(--maxw); margin:18px auto 60px; padding:0 16px}
    .list{background:var(--panel); border:1px solid var(--border); border-radius:12px; overflow:hidden}


    .hint{color:#000000; font-size:20px}
    footer{max-width:var(--maxw); margin:0 auto 40px; padding:0 16px; color:var(--muted); font-size:22px}

@media (max-width: 600px){
  .logo{
    position: static;        /* pole enam fixed */
    display: block;
    width:40px; height:40px;
    margin:8px 0 0 8px;      /* väike serv */
  }
  header{ margin-top:12px; } /* enam pole suurt ülemist vahet vaja */
}

/* grid */
.brand-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  max-width: 1200px;
  margin: 18px auto 60px;
  padding: 0 16px;
}

.brand-card {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 25px;
  padding: 24px 16px;
  text-decoration: none;
  color: var(--link);
  transition: transform 0.2s, background 0.2s;
  text-align: center;
}

.brand-card:hover {
  background: #FFFFFF;
  transform: translateY(-3px);
}

.brand-logo {
  width: 100px;
  height: 100px;
  object-fit: contain;
  margin-bottom: 12px;
  background: #FFFFFF;
  border-radius: 8px;
}

.brand-name {
  font-size: 25px;
  font-weight: bold;
  margin-bottom: 6px;
}

.hint {
  font-size: 16px;
  color: #000000;
}

/* --- TOP edetabel paremas servas --- */
#top-models-sidebar{
  position: fixed; right: 16px; top: 16px;
  width: 300px; max-height: calc(100dvh - 32px);
  overflow: auto; z-index: 10;
  background: #ffffffcc; backdrop-filter: blur(6px);
  border: 1px solid #000000; border-radius: 16px;
  padding: 12px 14px; box-shadow: 0 2px 10px rgba(0,0,0,.08);
  font-size: 18px; line-height: 1.25;
}
#top-models-sidebar h3{ margin: 0 0 8px; font-size: 22px; }
#top-models-sidebar ol{ list-style: none; margin: 8px 0 0; padding: 0; }
#top-models-sidebar li{
  display:flex; justify-content:space-between; gap:10px; align-items:baseline;
  padding: 6px 0; border-bottom: 1px solid #000000;
}
#top-models-sidebar li:last-child{ border-bottom: 0; }
#top-models-sidebar .names a{ color: var(--link); text-decoration: none; }
#top-models-sidebar .names a:hover{ text-decoration: underline; }
#top-models-sidebar .count{ opacity:.7; }

@media (max-width: 1200px){
  #top-models-sidebar{
    position: static; width:auto; max-width: var(--maxw);
    margin: 12px auto; display:block;
  }
}

  </style>

</head>
<body>
  <img class="logo" src="img/logo2.png" alt="Logo" onerror="this.remove()"/>

<header>
  <h1>JOELI KOLLEKTSIOON</h1>
  <p class="lead">ERINEVAID MUDELEID: <span id="count">0</span></p>
</header>

  <main class="brand-grid">

  <a class="brand-card" href="astonmartin/index.html">
    <img src="img/logod/astonmartin.jpg" alt="Aston Martin logo" class="brand-logo">
    <span class="brand-name">Aston Martin</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="audi/index.html">
    <img src="img/logod/audi.png" alt="Audi logo" class="brand-logo">
    <span class="brand-name">Audi</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="bmw/index.html">
    <img src="img/logod/bmw.png" alt="BMW logo" class="brand-logo">
    <span class="brand-name">BMW</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="bugatti/index.html">
    <img src="img/logod/bugatti.jpg" alt="Bugatti logo" class="brand-logo">
    <span class="brand-name">BUGATTI</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="buick/index.html">
    <img src="img/logod/buick.png" alt="Buick logo" class="brand-logo">
    <span class="brand-name">Buick</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="cadillac/index.html">
    <img src="img/logod/cadillac.png" alt="Cadillac logo" class="brand-logo">
    <span class="brand-name">Cadillac</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="chevrolet/index.html">
    <img src="img/logod/chevrolet.jpg" alt="Chevrolet logo" class="brand-logo">
    <span class="brand-name">Chevrolet</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="datsun/index.html">
    <img src="img/logod/datsun.png" alt="Datsun logo" class="brand-logo">
    <span class="brand-name">Datsun</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="dodge/index.html">
    <img src="img/logod/dodge.png" alt="Dodge logo" class="brand-logo">
    <span class="brand-name">Dodge</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="ferrari/index.html">
    <img src="img/logod/ferrari.png" alt="Ferrari logo" class="brand-logo">
    <span class="brand-name">Ferrari</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="fiat/index.html">
    <img src="img/logod/fiat.png" alt="Fiat logo" class="brand-logo">
    <span class="brand-name">Fiat</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="ford/index.html">
    <img src="img/logod/ford.png" alt="Ford logo" class="brand-logo">
    <span class="brand-name">Ford</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="honda/index.html">
    <img src="img/logod/honda.png" alt="Honda logo" class="brand-logo">
    <span class="brand-name">Honda</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="jaguar/index.html">
    <img src="img/logod/jaguar.png" alt="Jaguar logo" class="brand-logo">
    <span class="brand-name">Jaguar</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="lamborghini/index.html">
    <img src="img/logod/lambo.png" alt="Lamborghini logo" class="brand-logo">
    <span class="brand-name">Lamborghini</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="lotus/index.html">
    <img src="img/logod/lotus.png" alt="Lotus logo" class="brand-logo">
    <span class="brand-name">Lotus</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="maserati/index.html">
    <img src="img/logod/maserati.png" alt="Maserati logo" class="brand-logo">
    <span class="brand-name">Maserati</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="mazda/index.html">
    <img src="img/logod/mazda.png" alt="Mazda logo" class="brand-logo">
    <span class="brand-name">Mazda</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="mercedes-benz/index.html">
    <img src="img/logod/mercedes.png" alt="Mercedes-Benz logo" class="brand-logo">
    <span class="brand-name">Mercedes-Benz</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="mercury/index.html">
    <img src="img/logod/mercury.png" alt="Mercury logo" class="brand-logo">
    <span class="brand-name">Mercury</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="mitsubishi/index.html">
    <img src="img/logod/mitsu.png" alt="Mitsubishi logo" class="brand-logo">
    <span class="brand-name">Mitsubishi</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="nissan/index.html">
    <img src="img/logod/nissan.png" alt="Nissan logo" class="brand-logo">
    <span class="brand-name">Nissan</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="pontiac/index.html">
    <img src="img/logod/pontiac.png" alt="Pontiac logo" class="brand-logo">
    <span class="brand-name">Pontiac</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="porsche/index.html">
    <img src="img/logod/porsche.png" alt="Porsche logo" class="brand-logo">
    <span class="brand-name">Porsche</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="proton/index.html">
    <img src="img/logod/proton.png" alt="Proton logo" class="brand-logo">
    <span class="brand-name">Proton</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="subaru/index.html">
    <img src="img/logod/subaru.png" alt="Subaru logo" class="brand-logo">
    <span class="brand-name">Subaru</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="toyota/index.html">
    <img src="img/logod/toyota.png" alt="Toyota logo" class="brand-logo">
    <span class="brand-name">Toyota</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="volkswagen/index.html">
    <img src="img/logod/volks.png" alt="Volkswagen logo" class="brand-logo">
    <span class="brand-name">Volkswagen</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="volvo/index.html">
    <img src="img/logod/volvo.png" alt="Volvo logo" class="brand-logo">
    <span class="brand-name">Volvo</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="wmotors/index.html">
    <img src="img/logod/wmotors.png" alt="W Motors logo" class="brand-logo">
    <span class="brand-name">W Motors</span>
    <span class="hint"></span>
  </a>

  <a class="brand-card" href="f1/index.html">
    <img src="img/logod/f1.png" alt="F1 logo" class="brand-logo">
    <span class="brand-name">F1</span>
    <span class="hint"></span>
  </a>

  </main>

  <footer>© <span id="year"></span></footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>

<script>
(function(){
  // Väike util
  const slug = (s) => String(s||'')
    .normalize('NFD').replace(/[\u0300-\u036f]/g,'')
    .toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'');

  // Loome parempoolse paneeli
  const sidebar = document.createElement('aside');
  sidebar.id = 'top-models-sidebar';
  sidebar.innerHTML = `<h3>TOP mudelid</h3><ol id="top-list"></ol>`;
  document.body.appendChild(sidebar);

  const brandCards = [...document.querySelectorAll('.brand-card')];
  let totalModels = 0;

  // Kui failina avatud, katkestame (nagu sul juba oli)
  if (location.protocol === 'file:') {
    console.warn('Ava leht läbi http://localhost:8000 või GitHub Pages.');
    document.getElementById('count').textContent = '—';
    return;
  }

  // Mudelite koondus: key = make|||model -> {make, model, count, brandHref}
  const map = new Map();

  // Heuristika mudelinime leidmiseks alamlehel
  function extractModelsFromDoc(doc){
    const out = [];

    // 1) Kaardid klassiga .card
    const cards = [...doc.querySelectorAll('.card')];

    for (const el of cards){
      // Proovime kõigepealt data-* atribuute
      let model =
        el.getAttribute?.('data-model') ||
        el.dataset?.model ||
        el.querySelector?.('[data-model]')?.getAttribute('data-model') ||
        el.querySelector?.('[itemprop="model"]')?.textContent ||
        el.querySelector?.('.model, .model-name, .title, h3, h2')?.textContent ||
        el.getAttribute?.('aria-label') ||
        '';

      model = (model || '').toString().trim();
      if (!model) continue;

      // Puhasta liigsed tühikud/sulud jms
      model = model.replace(/\s+/g,' ').replace(/\s*[\(\[][^)\]]*[\)\]]\s*/g,'').trim();
      if (!model) continue;

      out.push(model);
    }

    // 2) Fallback: meta(name="models") content="Model1;Model2;..."
    if (!out.length){
      const metaList = doc.querySelector('meta[name="models"]')?.content || '';
      if (metaList){
        metaList.split(/[;,]/).map(s=>s.trim()).filter(Boolean).forEach(m => out.push(m));
      }
    }

    // 3) Fallback: kõik elemendid, millel on [data-model]
    if (!out.length){
      doc.querySelectorAll('[data-model]').forEach(n=>{
        const m = n.getAttribute('data-model')?.trim();
        if (m) out.push(m);
      });
    }

    return out;
  }

  // Põhitsükkel: käime brändid läbi, loeme mudelid ja kogume TOP jaoks
  (async () => {
    await Promise.all(brandCards.map(async (card) => {
      const brandHref = card.getAttribute('href');
      const hintSpan = card.querySelector('.hint');
      const brandName = (card.querySelector('.brand-name')?.textContent || '').trim();

      if (!brandHref) return;

      try{
        const res = await fetch(brandHref, { cache: 'no-store' });
        if (!res.ok) return;

        const html = await res.text();
        const doc = new DOMParser().parseFromString(html, 'text/html');

        // Püüa võtta brändi nimi lehelt (meta), kui olemas
        const metaBrand = doc.querySelector('meta[name="brand"]')?.content?.trim();
        const make = metaBrand || brandName || '';

        // Mudelite leidmine
        let models = extractModelsFromDoc(doc);

        // Kui ei leidnud, kasuta sinu varasemat "lihtsat loendust" ja jäta nimedeta (ei lähe TOPi)
        if (!models.length){
          let n = doc.querySelectorAll('.card').length;
          if (!n) {
            const meta = doc.querySelector('meta[name="models-count"]');
            if (meta) n = parseInt(meta.content) || 0;
          }
          totalModels += n;
          if (hintSpan) hintSpan.textContent = n ? `(${n})` : '';
          return;
        }

        // Arvuta kogusumma ja brändile vihje
        totalModels += models.length;
        if (hintSpan) hintSpan.textContent = `(${models.length})`;

        // Koonda TOP jaoks
        for (const model of models){
          const key = `${make}|||${model}`;
          const row = map.get(key) || { make, model, count: 0, brandHref };
          row.count++;
          row.brandHref = brandHref; // hoia viimast/ainust
          map.set(key, row);
        }

      }catch(e){
        // vaikus – kui mõni leht ei vasta, jätame vahele
      }
    }));

    // Uuenda kokkuarv
    const totalEl = document.getElementById('count');
    if (totalEl) totalEl.textContent = totalModels;

    // TOP edetabel
    const ranked = Array.from(map.values())
      .sort((a,b)=> b.count - a.count || a.make.localeCompare(b.make) || a.model.localeCompare(b.model))
      .slice(0, 15);

    const list = document.getElementById('top-list');
    list.innerHTML = ranked.map(({make, model, count, brandHref}) => {
      const brandUrl = brandHref;                     // sinu olemasolev tootjaleht
      const modelUrl = `${brandHref}?m=${encodeURIComponent(model)}`; // tulevikus saad alamlehel sellega mudeleid filtreerida/kerida
      return `
        <li>
          <span class="names">
            <a href="${brandUrl}" aria-label="Tootja: ${make}">${make}</a>
            &nbsp;•&nbsp;
            <a href="${modelUrl}" aria-label="Mudel: ${model}">${model}</a>
          </span>
          <span class="count">${count}</span>
        </li>`;
    }).join('') || `<li><span class="names">Andmeid ei leitud</span></li>`;
  })();
})();
</script>


</body>
</html>

